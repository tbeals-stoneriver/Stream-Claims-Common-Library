<?xml version="1.0" encoding="UTF-8"?>


<#assign outboundDocumentNode = doc.outboundDocument>

<#if outboundDocumentNode?has_content>
	<@createTransformedXML documentNode=outboundDocumentNode/>
<#else>
	<#assign outboundDocumentNodes = doc.outboundDocuments>

	<#list outboundDocumentNodes?children as outboundDocumentNode>
		<#if outboundDocumentNode?node_type != 'text'>
			<@createTransformedXML documentNode=outboundDocumentNode/>
		</#if>
	</#list>
</#if>


<#macro createTransformedXML documentNode>

	<LETTER_DATA xmlns="http://www.w3.org/2001/XMLSchema-instance" noNamespaceSchemaLocation="C:\xPression\CustomerData\Schema\LETTER_DATA.xsd">
		<LETTER_RECORD>

			<#assign document = documentNode.document>

			<SR_DOCUMENT_ID_PK>${document.recordId}</SR_DOCUMENT_ID_PK>
			<EFFECTIVE_DATE>${document.createdDateTime}</EFFECTIVE_DATE>

			<LANGUAGE>English</LANGUAGE>

			<JURISDICTION>TX</JURISDICTION>

			<!-- I have changed the recipient types to "Primary" or "CC".  How many CC recipients would we need?  I have coded 15 for now. -->
			<PRIMARY_REC_PDF_FAX_FLAG>Y</PRIMARY_REC_PDF_FAX_FLAG>
			<PRIMARY_REC_PDF_EMAIL_FLAG>Y</PRIMARY_REC_PDF_EMAIL_FLAG>
			<PRIMARY_REC_PDF_NO_FAX_EMAIL_FLAG>Y</PRIMARY_REC_PDF_NO_FAX_EMAIL_FLAG>
			<PRIMARY_REC_PS_FLAG>Y</PRIMARY_REC_PS_FLAG>
			<CC_1_REC_PDF_FAX_FLAG>Y</CC_1_REC_PDF_FAX_FLAG>
			<CC_1_REC_PDF_EMAIL_FLAG>Y</CC_1_REC_PDF_EMAIL_FLAG>
			<CC_1_REC_PDF_NO_FAX_EMAIL_FLAG>Y</CC_1_REC_PDF_NO_FAX_EMAIL_FLAG>
			<CC_1_REC_PS_FLAG>Y</CC_1_REC_PS_FLAG>
			<CC_2_REC_PDF_FAX_FLAG>Y</CC_2_REC_PDF_FAX_FLAG>
			<CC_2_REC_PDF_EMAIL_FLAG>Y</CC_2_REC_PDF_EMAIL_FLAG>
			<CC_2_REC_PDF_NO_FAX_EMAIL_FLAG>Y</CC_2_REC_PDF_NO_FAX_EMAIL_FLAG>
			<CC_2_REC_PS_FLAG>Y</CC_2_REC_PS_FLAG>
			<CC_3_REC_PDF_FAX_FLAG>Y</CC_3_REC_PDF_FAX_FLAG>
			<CC_3_REC_PDF_EMAIL_FLAG>Y</CC_3_REC_PDF_EMAIL_FLAG>
			<CC_3_REC_PDF_NO_FAX_EMAIL_FLAG>Y</CC_3_REC_PDF_NO_FAX_EMAIL_FLAG>
			<CC_3_REC_PS_FLAG>Y</CC_3_REC_PS_FLAG>
			<CC_4_REC_PDF_FAX_FLAG>Y</CC_4_REC_PDF_FAX_FLAG>
			<CC_4_REC_PDF_EMAIL_FLAG>Y</CC_4_REC_PDF_EMAIL_FLAG>
			<CC_4_REC_PDF_NO_FAX_EMAIL_FLAG>Y</CC_4_REC_PDF_NO_FAX_EMAIL_FLAG>
			<CC_4_REC_PS_FLAG>Y</CC_4_REC_PS_FLAG>
			<CC_5_REC_PDF_FAX_FLAG>Y</CC_5_REC_PDF_FAX_FLAG>
			<CC_5_REC_PDF_EMAIL_FLAG>Y</CC_5_REC_PDF_EMAIL_FLAG>
			<CC_5_REC_PDF_NO_FAX_EMAIL_FLAG>Y</CC_5_REC_PDF_NO_FAX_EMAIL_FLAG>
			<CC_5_REC_PS_FLAG>Y</CC_5_REC_PS_FLAG>
			<CC_6_REC_PDF_FAX_FLAG>Y</CC_6_REC_PDF_FAX_FLAG>
			<CC_6_REC_PDF_EMAIL_FLAG>Y</CC_6_REC_PDF_EMAIL_FLAG>
			<CC_6_REC_PDF_NO_FAX_EMAIL_FLAG>Y</CC_6_REC_PDF_NO_FAX_EMAIL_FLAG>
			<CC_6_REC_PS_FLAG>Y</CC_6_REC_PS_FLAG>
			<CC_7_REC_PDF_FAX_FLAG>Y</CC_7_REC_PDF_FAX_FLAG>
			<CC_7_REC_PDF_EMAIL_FLAG>Y</CC_7_REC_PDF_EMAIL_FLAG>
			<CC_7_REC_PDF_NO_FAX_EMAIL_FLAG>Y</CC_7_REC_PDF_NO_FAX_EMAIL_FLAG>
			<CC_7_REC_PS_FLAG>Y</CC_7_REC_PS_FLAG>
			<CC_8_REC_PDF_FAX_FLAG>Y</CC_8_REC_PDF_FAX_FLAG>
			<CC_8_REC_PDF_EMAIL_FLAG>Y</CC_8_REC_PDF_EMAIL_FLAG>
			<CC_8_REC_PDF_NO_FAX_EMAIL_FLAG>Y</CC_8_REC_PDF_NO_FAX_EMAIL_FLAG>
			<CC_8_REC_PS_FLAG>Y</CC_8_REC_PS_FLAG>
			<CC_9_REC_PDF_FAX_FLAG>Y</CC_9_REC_PDF_FAX_FLAG>
			<CC_9_REC_PDF_EMAIL_FLAG>Y</CC_9_REC_PDF_EMAIL_FLAG>
			<CC_9_REC_PDF_NO_FAX_EMAIL_FLAG>Y</CC_9_REC_PDF_NO_FAX_EMAIL_FLAG>
			<CC_9_REC_PS_FLAG>Y</CC_9_REC_PS_FLAG>
			<CC_10_REC_PDF_FAX_FLAG>Y</CC_10_REC_PDF_FAX_FLAG>
			<CC_10_REC_PDF_EMAIL_FLAG>Y</CC_10_REC_PDF_EMAIL_FLAG>
			<CC_10_REC_PDF_NO_FAX_EMAIL_FLAG>Y</CC_10_REC_PDF_NO_FAX_EMAIL_FLAG>
			<CC_10_REC_PS_FLAG>Y</CC_10_REC_PS_FLAG>
			<CC_11_REC_PDF_FAX_FLAG>Y</CC_11_REC_PDF_FAX_FLAG>
			<CC_11_REC_PDF_EMAIL_FLAG>Y</CC_11_REC_PDF_EMAIL_FLAG>
			<CC_11_REC_PDF_NO_FAX_EMAIL_FLAG>Y</CC_11_REC_PDF_NO_FAX_EMAIL_FLAG>
			<CC_11_REC_PS_FLAG>Y</CC_11_REC_PS_FLAG>
			<CC_12_REC_PDF_FAX_FLAG>Y</CC_12_REC_PDF_FAX_FLAG>
			<CC_12_REC_PDF_EMAIL_FLAG>Y</CC_12_REC_PDF_EMAIL_FLAG>
			<CC_12_REC_PDF_NO_FAX_EMAIL_FLAG>Y</CC_12_REC_PDF_NO_FAX_EMAIL_FLAG>
			<CC_12_REC_PS_FLAG>Y</CC_12_REC_PS_FLAG>
			<CC_13_REC_PDF_FAX_FLAG>Y</CC_13_REC_PDF_FAX_FLAG>
			<CC_13_REC_PDF_EMAIL_FLAG>Y</CC_13_REC_PDF_EMAIL_FLAG>
			<CC_13_REC_PDF_NO_FAX_EMAIL_FLAG>Y</CC_13_REC_PDF_NO_FAX_EMAIL_FLAG>
			<CC_13_REC_PS_FLAG>Y</CC_13_REC_PS_FLAG>
			<CC_14_REC_PDF_FAX_FLAG>Y</CC_14_REC_PDF_FAX_FLAG>
			<CC_14_REC_PDF_EMAIL_FLAG>Y</CC_14_REC_PDF_EMAIL_FLAG>
			<CC_14_REC_PDF_NO_FAX_EMAIL_FLAG>Y</CC_14_REC_PDF_NO_FAX_EMAIL_FLAG>
			<CC_14_REC_PS_FLAG>Y</CC_14_REC_PS_FLAG>
			<CC_15_REC_PDF_FAX_FLAG>Y</CC_15_REC_PDF_FAX_FLAG>
			<CC_15_REC_PDF_EMAIL_FLAG>Y</CC_15_REC_PDF_EMAIL_FLAG>
			<CC_15_REC_PDF_NO_FAX_EMAIL_FLAG>Y</CC_15_REC_PDF_NO_FAX_EMAIL_FLAG>
			<CC_15_REC_PS_FLAG>Y</CC_15_REC_PS_FLAG>
			<!-- Need to work with Kirk on the OP details below. -->
			<!-- Added additional fields for xPression OP processing. -->

			<LETTER_DOCUMENT_TEMPLATE_NAME>${document.documentTemplateName}</LETTER_DOCUMENT_TEMPLATE_NAME>

			<!-- The following fields only apply to the Main Recipient correct?  These are used for central print file splitting.  If recipients are CCed, how does this work?  This should be moved to to the distribution table per John. -->
			<ENVELOPE_ARTWORK_COLOR>X</ENVELOPE_ARTWORK_COLOR>
			<!-- Possible COST_CENTER values based on current PRAC business rules: -->
			<!-- "Wall", "Horsham", or other values are valid for NJ. -->
			<COST_CENTER>X</COST_CENTER>
			<BRE_FLAG>Y</BRE_FLAG>
			<CRT_FLAG>Y</CRT_FLAG>
			<RRR_FLAG>Y</RRR_FLAG>
			<!-- Added the following for the bar code.  Should these fields be moved to the ENDORSEMENT table?  Are any of these fields duplicates? -->
			<!-- This field is to hold the: Hard coded value of “IR”.  What should this field be named? -->
			<IR_VALUE>IR</IR_VALUE>
			<HISTORY_ID>X</HISTORY_ID>
			<!-- This field is to hold the: Hard coded value of slash (“/”).  What should this field be named? -->
			<BARCODE_SEPARATOR>/</BARCODE_SEPARATOR>
			<NUMERIC_FOLDER_IDENTIFIER>X</NUMERIC_FOLDER_IDENTIFIER>
			<HISTORY_KEY>X</HISTORY_KEY>
			<!-- This field is to hold the: Hard coded value of “/7_/”.  Should I keep the slashes in this field?  What should this field be named? -->
			<SEVEN_UNDERSCORE>/7_/</SEVEN_UNDERSCORE>
			<CLIENT_LETTER_RELATED_ID>X</CLIENT_LETTER_RELATED_ID>
			<!-- Should this now be called an "ENDORSEMENT"? -->
			<CLIENT_LETTER_ATTACHMENT_NAME>X</CLIENT_LETTER_ATTACHMENT_NAME>
			<!-- Added the following for the archive file naming.  How do we make this unique for each output file?  Also, are any of these duplicates? -->
			<DRAWER>X</DRAWER>
			<!-- This field is to hold the: Hard coded value of underscore (“_”).  What should this field be named? -->
			<ARCHIVE_SEPARATOR>_</ARCHIVE_SEPARATOR>
			<FILE_NUMBER>X</FILE_NUMBER>
			<FOLDER_TYPE>X</FOLDER_TYPE>
			<DOCUMENT_TYPE>X</DOCUMENT_TYPE>
			<!-- Should this be the same as the date printed on the letter? -->
			<DOCUMENT_DATE>X</DOCUMENT_DATE>
			<FILE_NAME>X</FILE_NAME>
			<!-- How are these "userdata" fields used?  Are these the same as the prompts for the letter? -->
			<USERDATA1>X</USERDATA1>
			<USERDATA2>X</USERDATA2>
			<USERDATA3>X</USERDATA3>
			<USERDATA4>X</USERDATA4>
			<USERDATA5>X</USERDATA5>
			<DOCUMENT_IDENTIFIER>X</DOCUMENT_IDENTIFIER>
			<PAGE_DESCRIPTION>X</PAGE_DESCRIPTION>
			<FLOW_ID>X</FLOW_ID>
			<STEP_ID>X</STEP_ID>
			<USER_ID>X</USER_ID>
			<PRIORITY>X</PRIORITY>
			<TASK_DESCRIPTION>X</TASK_DESCRIPTION>
			<FILE_JACKET>X</FILE_JACKET>
			<CONVERSION_FLAG>X</CONVERSION_FLAG>
			<UNIQUE_ID>X</UNIQUE_ID>
			<!-- End of additional fields added for xPression OP processing. -->
			<!-- End of working with Kirk. -->
			<!-- Fields added per PRAC business rules. These fields apply to the letter being generated and contain user entered "UE" data. -->
			<UE_WHO_IS_THIS_LETTER_GOING_TO>X</UE_WHO_IS_THIS_LETTER_GOING_TO>
			<EPIP_OPTION>X</EPIP_OPTION>
			<UE_ELIGIBILITY_CAUSALITY_AVAILABILITY>X</UE_ELIGIBILITY_CAUSALITY_AVAILABILITY>
			<UE_NUMBER_OF_CLAIMANTS_1_6>1</UE_NUMBER_OF_CLAIMANTS_1_6>
			<UE_IS_COVERAGE_IN_QUESTION_Y_N>N</UE_IS_COVERAGE_IN_QUESTION_Y_N>
			<UE_EXTENDED_MED_PAY_COVERAGE_AMOUNT>X</UE_EXTENDED_MED_PAY_COVERAGE_AMOUNT>
			<UE_IS_HEALTH_CARRIER_PRIMARY>X</UE_IS_HEALTH_CARRIER_PRIMARY>
			<UE_DOES_THE_PIP_EXCLUTION_APPLY>X</UE_DOES_THE_PIP_EXCLUTION_APPLY>
			<UE_DOES_LOST_WAGES_AND_ESSENTIAL_SERVICE_COV_APPLY>X</UE_DOES_LOST_WAGES_AND_ESSENTIAL_SERVICE_COV_APPLY>
			<UE_INCOME_TAX_FROM_YEAR>X</UE_INCOME_TAX_FROM_YEAR>
			<UE_INCOME_TAX_THROUGH_YEAR>X</UE_INCOME_TAX_THROUGH_YEAR>
			<UE_FREEFORM>X</UE_FREEFORM>
			<VEHICLE_YEAR>X</VEHICLE_YEAR>
			<VEHICLE_MAKE>X</VEHICLE_MAKE>
			<VEHICLE_MODEL>X</VEHICLE_MODEL>
			<UE_SALUTATION>X</UE_SALUTATION>
			<DATE_OF_INSPECTION>X</DATE_OF_INSPECTION>
			<SOCIAL_SECURITY_NUMBER>000-000-0000</SOCIAL_SECURITY_NUMBER>
			<OPTIONAL_PARAGRAPH_1>N</OPTIONAL_PARAGRAPH_1>
			<OPTIONAL_PARAGRAPH_2>N</OPTIONAL_PARAGRAPH_2>
			<OPTIONAL_PARAGRAPH_3>N</OPTIONAL_PARAGRAPH_3>
			<OPTIONAL_PARAGRAPH_4>N</OPTIONAL_PARAGRAPH_4>
			<OPTIONAL_PARAGRAPH_5>N</OPTIONAL_PARAGRAPH_5>
			<OPTIONAL_PARAGRAPH_6>N</OPTIONAL_PARAGRAPH_6>
			<OPTIONAL_PARAGRAPH_7>N</OPTIONAL_PARAGRAPH_7>
			<OPTIONAL_PARAGRAPH_8>N</OPTIONAL_PARAGRAPH_8>
			<OPTIONAL_PARAGRAPH_9>N</OPTIONAL_PARAGRAPH_9>
			<OPTIONAL_PARAGRAPH_10>N</OPTIONAL_PARAGRAPH_10>
			<OPTIONAL_PARAGRAPH_11>N</OPTIONAL_PARAGRAPH_11>
			<OPTIONAL_PARAGRAPH_12>N</OPTIONAL_PARAGRAPH_12>
			<OPTIONAL_PARAGRAPH_13>N</OPTIONAL_PARAGRAPH_13>
			<OPTIONAL_PARAGRAPH_14>N</OPTIONAL_PARAGRAPH_14>
			<OPTIONAL_PARAGRAPH_15>N</OPTIONAL_PARAGRAPH_15>
			<OPTIONAL_PARAGRAPH_16>N</OPTIONAL_PARAGRAPH_16>
			<OPTIONAL_PARAGRAPH_17>N</OPTIONAL_PARAGRAPH_17>
			<OPTIONAL_PARAGRAPH_18>N</OPTIONAL_PARAGRAPH_18>
			<OPTIONAL_PARAGRAPH_19>N</OPTIONAL_PARAGRAPH_19>
			<OPTIONAL_PARAGRAPH_20>N</OPTIONAL_PARAGRAPH_20>
			<OPTIONAL_PARAGRAPH_21>N</OPTIONAL_PARAGRAPH_21>
			<OPTIONAL_PARAGRAPH_22>N</OPTIONAL_PARAGRAPH_22>
			<OPTIONAL_PARAGRAPH_23>N</OPTIONAL_PARAGRAPH_23>
			<OPTIONAL_PARAGRAPH_24>N</OPTIONAL_PARAGRAPH_24>
			<OPTIONAL_PARAGRAPH_25>N</OPTIONAL_PARAGRAPH_25>
			<OPTIONAL_PARAGRAPH_26>N</OPTIONAL_PARAGRAPH_26>
			<OPTIONAL_PARAGRAPH_27>N</OPTIONAL_PARAGRAPH_27>
			<OPTIONAL_PARAGRAPH_28>N</OPTIONAL_PARAGRAPH_28>
			<OPTIONAL_PARAGRAPH_29>N</OPTIONAL_PARAGRAPH_29>
			<OPTIONAL_PARAGRAPH_30>N</OPTIONAL_PARAGRAPH_30>
			<OPTIONAL_PARAGRAPH_31>N</OPTIONAL_PARAGRAPH_31>
			<OPTIONAL_PARAGRAPH_32>N</OPTIONAL_PARAGRAPH_32>
			<OPTIONAL_PARAGRAPH_33>N</OPTIONAL_PARAGRAPH_33>
			<OPTIONAL_PARAGRAPH_34>N</OPTIONAL_PARAGRAPH_34>
			<OPTIONAL_PARAGRAPH_35>N</OPTIONAL_PARAGRAPH_35>
			<OPTIONAL_PARAGRAPH_36>N</OPTIONAL_PARAGRAPH_36>
			<OPTIONAL_PARAGRAPH_37>N</OPTIONAL_PARAGRAPH_37>
			<OPTIONAL_PARAGRAPH_38>N</OPTIONAL_PARAGRAPH_38>
			<OPTIONAL_PARAGRAPH_39>N</OPTIONAL_PARAGRAPH_39>
			<OPTIONAL_PARAGRAPH_40>N</OPTIONAL_PARAGRAPH_40>
			<!-- End of fields added per PRAC business rules here. -->
			<CLAIM_ADJUSTER>X</CLAIM_ADJUSTER>
			<CLAIM_TEAM>X</CLAIM_TEAM>
			<CLAIM_NUMBER>X</CLAIM_NUMBER>
			<POLICY_NUMBER>X</POLICY_NUMBER>
			<DATE_OF_LOSS>1990-01-01</DATE_OF_LOSS>
			<LOSS_STREET>X</LOSS_STREET>
			<LOSS_CITY>X</LOSS_CITY>
			<LOSS_STATE>X</LOSS_STATE>
			<UW_OFFICE>X</UW_OFFICE>
			<ORIGINAL_EFF_DATE>X</ORIGINAL_EFF_DATE>
			<EFFECTIVE_DATE>X</EFFECTIVE_DATE>
			<EXPIRATION_DATE>X</EXPIRATION_DATE>
			<LOGIN_HOURS>X</LOGIN_HOURS>
			<LOGIN_EMAIL>X</LOGIN_EMAIL>
			<LOGIN_NAME>X</LOGIN_NAME>
			<LOGIN_SIGNATURE>X</LOGIN_SIGNATURE>
			<LOGIN_EMPLOYEE_TYPE>X</LOGIN_EMPLOYEE_TYPE>
			<LOGIN_OFFICE_PHONE>X</LOGIN_OFFICE_PHONE>
			<LOGIN_HOME_PHONE>X</LOGIN_HOME_PHONE>
			<LOGIN_FAX_NUMBER>X</LOGIN_FAX_NUMBER>
			<LOGIN_USER_STATUS>X</LOGIN_USER_STATUS>
			<LOGIN_SUPERVISOR_ID>X</LOGIN_SUPERVISOR_ID>
			<LOGIN_TEAM_ID>X</LOGIN_TEAM_ID>





			<#assign documentCompanyValues = document.documentCompany>		

			<#if documentCompanyValues??>
				<COMPANY>
					<COMPANY_PK>${documentCompanyValues.companyId}</COMPANY_PK>
					<SR_DOCUMENT_ID_FK>${document.recordId}</SR_DOCUMENT_ID_FK>
					<CORPORATION_ID>${documentCompanyValues.corporationId}</CORPORATION_ID>
					<CORPORATION_NAME>${documentCompanyValues.corporationName}</CORPORATION_NAME>
					<COMPANY_ID>${documentCompanyValues.companyId}</COMPANY_ID>
					<COMPANY_NAME>${documentCompanyValues.companyName}</COMPANY_NAME>
					<COMPANY_DBA_NAME>${documentCompanyValues.companyDBAName}</COMPANY_DBA_NAME>


					<#assign companyMailingAddress = documentCompanyValues.companyMailingAddress>

					<#if companyMailingAddress??>
						<COMPANY_MAILING_ADDRESS_STREET1>${companyMailingAddress.street1}</COMPANY_MAILING_ADDRESS_STREET1>
						<COMPANY_MAILING_ADDRESS_STREET2>${companyMailingAddress.street2}</COMPANY_MAILING_ADDRESS_STREET2>
						<COMPANY_MAILING_ADDRESS_CITY>${companyMailingAddress.city}</COMPANY_MAILING_ADDRESS_CITY>
						<COMPANY_MAILING_ADDRESS_STATE>${companyMailingAddress.state}</COMPANY_MAILING_ADDRESS_STATE>
						<COMPANY_MAILING_ADDRESS_STATE_NAME>${companyMailingAddress.stateName}</COMPANY_MAILING_ADDRESS_STATE_NAME>
						<COMPANY_MAILING_ADDRESS_POSTAL_CODE>${companyMailingAddress.postalCode}</COMPANY_MAILING_ADDRESS_POSTAL_CODE>
						<COMPANY_MAILING_ADDRESS_COUNTRY_CODE>${companyMailingAddress.countryCode}</COMPANY_MAILING_ADDRESS_COUNTRY_CODE>
						<COMPANY_MAILING_ADDRESS_COUNTRY_NAME>${companyMailingAddress.countryName}</COMPANY_MAILING_ADDRESS_COUNTRY_NAME>
					</#if>

					<#list documentCompanyValues.companyPhoneNumbers.phone as companyPhoneNumbers>
						<COMPANY_PHONE_NUMBER>
							<!--what value should be  used here-->
							<COMPANY_PHONE_NUMBER_PK>1</COMPANY_PHONE_NUMBER_PK>
							<COMPANY_FK>${documentCompanyValues.companyId}</COMPANY_FK>
							<SR_DOCUMENT_ID_FK>${document.recordId}</SR_DOCUMENT_ID_FK>
							<COMPANY_PHONE_NUMBER>${companyPhoneNumbers.phoneNumber}</COMPANY_PHONE_NUMBER>
							<COMPANY_PHONE_EXTENSION>${companyPhoneNumbers.extension}</COMPANY_PHONE_EXTENSION>
							<COMPANY_PHONE_TYPE>${companyPhoneNumbers.type}</COMPANY_PHONE_TYPE>
						</COMPANY_PHONE_NUMBER>
					</#list>


					<#if documentCompanyValues.companyEmailAddress??>
						<COMPANY_EMAIL_ADDRESS>${documentCompanyValues.companyEmailAddress}</COMPANY_EMAIL_ADDRESS>
					</#if>

					<#if documentCompanyValues.companyWebSite??>
						<COMPANY_WEB_SITE>${documentCompanyValues.companyWebSite}</COMPANY_WEB_SITE>
					</#if>


					<COMPANY_SMALL_LOGO_FILE_NAME>${documentCompanyValues.companySmallLogoFileName}</COMPANY_SMALL_LOGO_FILE_NAME>
					<COMPANY_LARGE_LOGO_FILE_NAME>${documentCompanyValues.companyLargeLogoFileName}</COMPANY_LARGE_LOGO_FILE_NAME>


					<#list documentCompanyValues.companyExecutives.executive as companyExecutive>
						<COMPANY_EXECUTIVE>
							<!--what value should be  used here-->
							<COMPANY_EXECUTIVE_PK>1</COMPANY_EXECUTIVE_PK>
							<COMPANY_FK>${documentCompanyValues.companyId}</COMPANY_FK>
							<SR_DOCUMENT_ID_FK>${document.recordId}</SR_DOCUMENT_ID_FK>
							<COMPANY_EXECUTIVE_TITLE>${companyExecutive.title}</COMPANY_EXECUTIVE_TITLE>
							<COMPANY_EXECUTIVE_NAME>${companyExecutive.executiveName}</COMPANY_EXECUTIVE_NAME>
							<COMPANY_EXECUTIVE_SIG_FILE_NAME>${companyExecutive.executiveSignatureFileName}</COMPANY_EXECUTIVE_SIG_FILE_NAME>
						</COMPANY_EXECUTIVE>
					</#list>
					
					<#--
					<COMPANY_NAICS_CODE>${documentCompanyValues.naicsCode}</COMPANY_NAICS_CODE>
					<COMPANY_NAICS_CODE_GROUP>${documentCompanyValues.naicsGroupCode}</COMPANY_NAICS_CODE_GROUP>
					<COMPANY_NAICS_CARRIER_CODE>${documentCompanyValues.naicsCarrierCode}</COMPANY_NAICS_CARRIER_CODE>
					<COMPANY_ISO_GROUP_NUMBER>${documentCompanyValues.isoGroupNumber}</COMPANY_ISO_GROUP_NUMBER>
					<COMPANY_ISO_CARRIER_NUMBER>${documentCompanyValues.isoCarrierNumber}</COMPANY_ISO_CARRIER_NUMBER> -->
					
					<@checkNullValue xmlNode=documentCompanyValues objectName="naicsCode" elementName="COMPANY_NAICS_CODE"/>
					<@checkNullValue xmlNode=documentCompanyValues objectName="naicsGroupCode" elementName="COMPANY_NAICS_CODE_GROUP"/>
					<@checkNullValue xmlNode=documentCompanyValues objectName="naicsCarrierCode" elementName="COMPANY_NAICS_CARRIER_CODE"/>
					<@checkNullValue xmlNode=documentCompanyValues objectName="isoGroupNumber" elementName="COMPANY_ISO_GROUP_NUMBER"/>
					<@checkNullValue xmlNode=documentCompanyValues objectName="isoCarrierNumber" elementName="COMPANY_ISO_CARRIER_NUMBER"/>
					
					
					
				</COMPANY>
			</#if>


			<#assign ccFlag="N">

			<#assign sendTo = documentNode.recipients.sendToRecipient>
			<@recipientDetails recipient = sendTo documentDetails = document ccFlag = "N"/>

			<#assign ccRecs = documentNode.recipients.ccRecipients>

			<#if ccRecs?has_content && (ccRecs?size > 0)>
				<#list ccRecs?children as ccRecipient>
					<@recurseCCRecp recurNode=ccRecipient docDetails=document/>
				</#list>
			</#if>
			
			<#assign singleDataElements = documentNode.singleDataElements>
			<#if singleDataElements?? && singleDataElements?has_content>
				<#compress>
					<#list documentNode.singleDataElements?children as singleElements>
						<@recurseSingleDataElement recurNode=singleElements/>
					</#list>
				</#compress>
			</#if>
			
			<#assign tableDataElements = documentNode.tableDataElements>
			<#if tableDataElements?? && tableDataElements?has_content>
				<#compress>
					<#list documentNode.tableDataElements?children as tableElements>
						<@recurseTableDataElement recurNode=tableElements/>
					</#list>
				</#compress>
			</#if>

			<!-- Added this table to list the xPression enclosures (a.k.a forms/attachments) that should be attached to the xPression letter, if applicable. -->
			<ENCLOSURE>
				<ENCLOSURE_ID_PK>1</ENCLOSURE_ID_PK>
				<SR_DOCUMENT_ID_FK>1</SR_DOCUMENT_ID_FK>
				<ENCLOSURE_ORDER>1</ENCLOSURE_ORDER>
				<ENCLOSURE_DOCUMENT_TEMPLATE_NAME>PIP-ID-Card</ENCLOSURE_DOCUMENT_TEMPLATE_NAME>
				<ENCLOSURE_PRINT_NAME>X</ENCLOSURE_PRINT_NAME>
				<!-- This is currently a gap.  Stream doesn't intend to include variable data or optional paragraphs for "attachments". -->
		    <!-- <RW> - Agreed.  We can allow selection of one "level" (so which Enclosures), but don't support selections within that selection.  -->
				<ENCLOSURE_OPTIONAL_PARAGRAPH_1>N</ENCLOSURE_OPTIONAL_PARAGRAPH_1>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_2>N</ENCLOSURE_OPTIONAL_PARAGRAPH_2>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_3>N</ENCLOSURE_OPTIONAL_PARAGRAPH_3>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_4>N</ENCLOSURE_OPTIONAL_PARAGRAPH_4>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_5>N</ENCLOSURE_OPTIONAL_PARAGRAPH_5>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_6>N</ENCLOSURE_OPTIONAL_PARAGRAPH_6>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_7>N</ENCLOSURE_OPTIONAL_PARAGRAPH_7>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_8>N</ENCLOSURE_OPTIONAL_PARAGRAPH_8>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_9>N</ENCLOSURE_OPTIONAL_PARAGRAPH_9>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_10>N</ENCLOSURE_OPTIONAL_PARAGRAPH_10>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_11>N</ENCLOSURE_OPTIONAL_PARAGRAPH_11>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_12>N</ENCLOSURE_OPTIONAL_PARAGRAPH_12>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_13>N</ENCLOSURE_OPTIONAL_PARAGRAPH_13>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_14>N</ENCLOSURE_OPTIONAL_PARAGRAPH_14>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_15>N</ENCLOSURE_OPTIONAL_PARAGRAPH_15>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_16>N</ENCLOSURE_OPTIONAL_PARAGRAPH_16>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_17>N</ENCLOSURE_OPTIONAL_PARAGRAPH_17>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_18>N</ENCLOSURE_OPTIONAL_PARAGRAPH_18>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_19>N</ENCLOSURE_OPTIONAL_PARAGRAPH_19>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_20>N</ENCLOSURE_OPTIONAL_PARAGRAPH_20>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_21>N</ENCLOSURE_OPTIONAL_PARAGRAPH_21>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_22>N</ENCLOSURE_OPTIONAL_PARAGRAPH_22>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_23>N</ENCLOSURE_OPTIONAL_PARAGRAPH_23>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_24>N</ENCLOSURE_OPTIONAL_PARAGRAPH_24>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_25>N</ENCLOSURE_OPTIONAL_PARAGRAPH_25>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_26>N</ENCLOSURE_OPTIONAL_PARAGRAPH_26>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_27>N</ENCLOSURE_OPTIONAL_PARAGRAPH_27>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_28>N</ENCLOSURE_OPTIONAL_PARAGRAPH_28>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_29>N</ENCLOSURE_OPTIONAL_PARAGRAPH_29>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_30>N</ENCLOSURE_OPTIONAL_PARAGRAPH_30>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_31>N</ENCLOSURE_OPTIONAL_PARAGRAPH_31>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_32>N</ENCLOSURE_OPTIONAL_PARAGRAPH_32>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_33>N</ENCLOSURE_OPTIONAL_PARAGRAPH_33>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_34>N</ENCLOSURE_OPTIONAL_PARAGRAPH_34>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_35>N</ENCLOSURE_OPTIONAL_PARAGRAPH_35>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_36>N</ENCLOSURE_OPTIONAL_PARAGRAPH_36>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_37>N</ENCLOSURE_OPTIONAL_PARAGRAPH_37>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_38>N</ENCLOSURE_OPTIONAL_PARAGRAPH_38>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_39>N</ENCLOSURE_OPTIONAL_PARAGRAPH_39>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_40>N</ENCLOSURE_OPTIONAL_PARAGRAPH_40>
			</ENCLOSURE>
			<ENCLOSURE>
				<ENCLOSURE_ID_PK>2</ENCLOSURE_ID_PK>
				<SR_DOCUMENT_ID_FK>1</SR_DOCUMENT_ID_FK>
				<ENCLOSURE_ORDER>2</ENCLOSURE_ORDER>
				<ENCLOSURE_DOCUMENT_TEMPLATE_NAME>PIP1</ENCLOSURE_DOCUMENT_TEMPLATE_NAME>
				<ENCLOSURE_PRINT_NAME>X</ENCLOSURE_PRINT_NAME>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_1>N</ENCLOSURE_OPTIONAL_PARAGRAPH_1>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_2>N</ENCLOSURE_OPTIONAL_PARAGRAPH_2>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_3>N</ENCLOSURE_OPTIONAL_PARAGRAPH_3>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_4>N</ENCLOSURE_OPTIONAL_PARAGRAPH_4>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_5>N</ENCLOSURE_OPTIONAL_PARAGRAPH_5>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_6>N</ENCLOSURE_OPTIONAL_PARAGRAPH_6>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_7>N</ENCLOSURE_OPTIONAL_PARAGRAPH_7>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_8>N</ENCLOSURE_OPTIONAL_PARAGRAPH_8>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_9>N</ENCLOSURE_OPTIONAL_PARAGRAPH_9>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_10>N</ENCLOSURE_OPTIONAL_PARAGRAPH_10>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_11>N</ENCLOSURE_OPTIONAL_PARAGRAPH_11>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_12>N</ENCLOSURE_OPTIONAL_PARAGRAPH_12>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_13>N</ENCLOSURE_OPTIONAL_PARAGRAPH_13>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_14>N</ENCLOSURE_OPTIONAL_PARAGRAPH_14>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_15>N</ENCLOSURE_OPTIONAL_PARAGRAPH_15>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_16>N</ENCLOSURE_OPTIONAL_PARAGRAPH_16>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_17>N</ENCLOSURE_OPTIONAL_PARAGRAPH_17>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_18>N</ENCLOSURE_OPTIONAL_PARAGRAPH_18>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_19>N</ENCLOSURE_OPTIONAL_PARAGRAPH_19>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_20>N</ENCLOSURE_OPTIONAL_PARAGRAPH_20>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_21>N</ENCLOSURE_OPTIONAL_PARAGRAPH_21>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_22>N</ENCLOSURE_OPTIONAL_PARAGRAPH_22>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_23>N</ENCLOSURE_OPTIONAL_PARAGRAPH_23>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_24>N</ENCLOSURE_OPTIONAL_PARAGRAPH_24>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_25>N</ENCLOSURE_OPTIONAL_PARAGRAPH_25>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_26>N</ENCLOSURE_OPTIONAL_PARAGRAPH_26>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_27>N</ENCLOSURE_OPTIONAL_PARAGRAPH_27>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_28>N</ENCLOSURE_OPTIONAL_PARAGRAPH_28>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_29>N</ENCLOSURE_OPTIONAL_PARAGRAPH_29>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_30>N</ENCLOSURE_OPTIONAL_PARAGRAPH_30>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_31>N</ENCLOSURE_OPTIONAL_PARAGRAPH_31>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_32>N</ENCLOSURE_OPTIONAL_PARAGRAPH_32>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_33>N</ENCLOSURE_OPTIONAL_PARAGRAPH_33>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_34>N</ENCLOSURE_OPTIONAL_PARAGRAPH_34>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_35>N</ENCLOSURE_OPTIONAL_PARAGRAPH_35>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_36>N</ENCLOSURE_OPTIONAL_PARAGRAPH_36>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_37>N</ENCLOSURE_OPTIONAL_PARAGRAPH_37>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_38>N</ENCLOSURE_OPTIONAL_PARAGRAPH_38>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_39>N</ENCLOSURE_OPTIONAL_PARAGRAPH_39>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_40>N</ENCLOSURE_OPTIONAL_PARAGRAPH_40>
			</ENCLOSURE>
			<ENCLOSURE>
				<ENCLOSURE_ID_PK>3</ENCLOSURE_ID_PK>
				<SR_DOCUMENT_ID_FK>1</SR_DOCUMENT_ID_FK>
				<ENCLOSURE_ORDER>3</ENCLOSURE_ORDER>
				<ENCLOSURE_DOCUMENT_TEMPLATE_NAME>CertNoSSN</ENCLOSURE_DOCUMENT_TEMPLATE_NAME>
				<ENCLOSURE_PRINT_NAME>X</ENCLOSURE_PRINT_NAME>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_1>N</ENCLOSURE_OPTIONAL_PARAGRAPH_1>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_2>N</ENCLOSURE_OPTIONAL_PARAGRAPH_2>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_3>N</ENCLOSURE_OPTIONAL_PARAGRAPH_3>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_4>N</ENCLOSURE_OPTIONAL_PARAGRAPH_4>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_5>N</ENCLOSURE_OPTIONAL_PARAGRAPH_5>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_6>N</ENCLOSURE_OPTIONAL_PARAGRAPH_6>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_7>N</ENCLOSURE_OPTIONAL_PARAGRAPH_7>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_8>N</ENCLOSURE_OPTIONAL_PARAGRAPH_8>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_9>N</ENCLOSURE_OPTIONAL_PARAGRAPH_9>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_10>N</ENCLOSURE_OPTIONAL_PARAGRAPH_10>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_11>N</ENCLOSURE_OPTIONAL_PARAGRAPH_11>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_12>N</ENCLOSURE_OPTIONAL_PARAGRAPH_12>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_13>N</ENCLOSURE_OPTIONAL_PARAGRAPH_13>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_14>N</ENCLOSURE_OPTIONAL_PARAGRAPH_14>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_15>N</ENCLOSURE_OPTIONAL_PARAGRAPH_15>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_16>N</ENCLOSURE_OPTIONAL_PARAGRAPH_16>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_17>N</ENCLOSURE_OPTIONAL_PARAGRAPH_17>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_18>N</ENCLOSURE_OPTIONAL_PARAGRAPH_18>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_19>N</ENCLOSURE_OPTIONAL_PARAGRAPH_19>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_20>N</ENCLOSURE_OPTIONAL_PARAGRAPH_20>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_21>N</ENCLOSURE_OPTIONAL_PARAGRAPH_21>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_22>N</ENCLOSURE_OPTIONAL_PARAGRAPH_22>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_23>N</ENCLOSURE_OPTIONAL_PARAGRAPH_23>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_24>N</ENCLOSURE_OPTIONAL_PARAGRAPH_24>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_25>N</ENCLOSURE_OPTIONAL_PARAGRAPH_25>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_26>N</ENCLOSURE_OPTIONAL_PARAGRAPH_26>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_27>N</ENCLOSURE_OPTIONAL_PARAGRAPH_27>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_28>N</ENCLOSURE_OPTIONAL_PARAGRAPH_28>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_29>N</ENCLOSURE_OPTIONAL_PARAGRAPH_29>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_30>N</ENCLOSURE_OPTIONAL_PARAGRAPH_30>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_31>N</ENCLOSURE_OPTIONAL_PARAGRAPH_31>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_32>N</ENCLOSURE_OPTIONAL_PARAGRAPH_32>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_33>N</ENCLOSURE_OPTIONAL_PARAGRAPH_33>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_34>N</ENCLOSURE_OPTIONAL_PARAGRAPH_34>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_35>N</ENCLOSURE_OPTIONAL_PARAGRAPH_35>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_36>N</ENCLOSURE_OPTIONAL_PARAGRAPH_36>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_37>N</ENCLOSURE_OPTIONAL_PARAGRAPH_37>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_38>N</ENCLOSURE_OPTIONAL_PARAGRAPH_38>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_39>N</ENCLOSURE_OPTIONAL_PARAGRAPH_39>
				<ENCLOSURE_OPTIONAL_PARAGRAPH_40>N</ENCLOSURE_OPTIONAL_PARAGRAPH_40>
			</ENCLOSURE>
		</LETTER_RECORD>
	</LETTER_DATA>


</#macro>


<#macro recipientDetails recipient documentDetails ccFlag>
	<#if recipient?has_content>
	
		<RECIPIENT>
			<#if recipient.recipientRecordId?has_content>
				<RECIPIENT_RECORD_ID_PK>${recipient.recipientRecordId}</RECIPIENT_RECORD_ID_PK>
			</#if>

			<SR_DOCUMENT_ID_FK>${documentDetails.recordId}</SR_DOCUMENT_ID_FK>
			<RECIPIENT_CC_FLAG>ccFlag</RECIPIENT_CC_FLAG>

			<RECIPIENT_NAME>${recipient.name}</RECIPIENT_NAME>
			<RECIPIENT_PARTY_RECORD_ID>${(recipient.partyRecordId)}</RECIPIENT_PARTY_RECORD_ID>

			<RECIPIENT_PARTICIPATION_CONTEXT_CODE>${recipient.participationContextCode}</RECIPIENT_PARTICIPATION_CONTEXT_CODE>
			<RECIPIENT_PARTICIPATION_CONTEXT_NAME>${recipient.participationContextName}</RECIPIENT_PARTICIPATION_CONTEXT_NAME>
			<RECIPIENT_PARTICIPATION_TYPE>${recipient.participationType}</RECIPIENT_PARTICIPATION_TYPE>
			<RECIPIENT_PARTICIPATION_TYPE_NAME>${recipient.participationTypeName}</RECIPIENT_PARTICIPATION_TYPE_NAME>
			<RECIPIENT_SPECIAL_IND>${recipient.specialRecipientInd}</RECIPIENT_SPECIAL_IND>
			<RECIPIENT_PARTY_ROLE_TYPE>${recipient.partyRoleType}</RECIPIENT_PARTY_ROLE_TYPE>
			<RECIPIENT_PARTY_ROLE_TYPE_NAME>${recipient.partyRoleTypeName}</RECIPIENT_PARTY_ROLE_TYPE_NAME>
			<RECIPIENT_PARTY_TYPE_CODE>${recipient.partyTypeCode}</RECIPIENT_PARTY_TYPE_CODE>
			<RECIPIENT_PARTY_TYPE_NAME>${recipient.partyTypeName}</RECIPIENT_PARTY_TYPE_NAME>

			<#if recipient.phone?has_content>
				<RECIPIENT_PHONE_NUMBER>${recipient.phone.phoneNumber}</RECIPIENT_PHONE_NUMBER>
				<RECIPIENT_PHONE_EXTENSION>${recipient.phone.extension}</RECIPIENT_PHONE_EXTENSION>
				<RECIPIENT_PHONE_TYPE>${recipient.phone.type}</RECIPIENT_PHONE_TYPE>
			</#if>

			<!--what value should be  used here-->
			<RECIPIENT_TYPE>recipient.</RECIPIENT_TYPE>

			<#if recipient.mailingAddress?has_content>
				<#assign mailingAddress = recipient.mailingAddress>


				<DISTRIBUTION>
					<!--what value should be  used here-->
					<DISTRIBUTION_ID_PK>1</DISTRIBUTION_ID_PK>
					<#if recipient.recipientRecordId?has_content>
						<RECIPIENT_RECORD_ID_PK>${recipient.recipientRecordId}</RECIPIENT_RECORD_ID_PK>
					</#if>
					<SR_DOCUMENT_ID_FK>${documentDetails.recordId}</SR_DOCUMENT_ID_FK>

					<!--what value should be  used here-->
					<DISTRIBUTION_DELIVERY_TYPE>X</DISTRIBUTION_DELIVERY_TYPE>

					<DISTRIBUTION_ADDR_IN_CARE_OF_NAME>${mailingAddress.inCareOfName}</DISTRIBUTION_ADDR_IN_CARE_OF_NAME>
					<DISTRIBUTION_ADDR_IN_CARE_OF_RECORD_ID>${mailingAddress.inCareOfRecordId}</DISTRIBUTION_ADDR_IN_CARE_OF_RECORD_ID>
					<DISTRIBUTION_ADDR_ATTENTION_TO_NAME>${mailingAddress.attentionToName}</DISTRIBUTION_ADDR_ATTENTION_TO_NAME>
					<DISTRIBUTION_ADDR_STREET1>${mailingAddress.street1}</DISTRIBUTION_ADDR_STREET1>
					<DISTRIBUTION_ADDR_STREET2>${mailingAddress.street2}</DISTRIBUTION_ADDR_STREET2>
					<DISTRIBUTION_ADDR_CITY>${mailingAddress.city}</DISTRIBUTION_ADDR_CITY>
					<DISTRIBUTION_ADDR_STATE>${mailingAddress.state}</DISTRIBUTION_ADDR_STATE>
					<DISTRIBUTION_ADDR_STATE_NAME>${mailingAddress.stateName}</DISTRIBUTION_ADDR_STATE_NAME>
					<DISTRIBUTION_ADDR_POSTAL_CODE>${mailingAddress.postalCode}</DISTRIBUTION_ADDR_POSTAL_CODE>
					<DISTRIBUTION_ADDR_COUNTRY_CODE>${mailingAddress.countryCode}</DISTRIBUTION_ADDR_COUNTRY_CODE>
					<DISTRIBUTION_ADDR_COUNTRY_NAME>${mailingAddress.countryName}</DISTRIBUTION_ADDR_COUNTRY_NAME>

					<!-- <DISTRIBUTION_EMAIL_ADDRESS>mailingAddress.</DISTRIBUTION_EMAIL_ADDRESS>
					<DISTRIBUTION_EMAIL_SUBJECT_TEXT>mailingAddress.</DISTRIBUTION_EMAIL_SUBJECT_TEXT>
					<DISTRIBUTION_EMAIL_MESSAGE_TEXT>mailingAddress.</DISTRIBUTION_EMAIL_MESSAGE_TEXT>
					<DISTRIBUTION_FAX_NUMBER>mailingAddress.</DISTRIBUTION_FAX_NUMBER>
					<DISTRIBUTION_FAX_EXTENSION>mailingAddress.</DISTRIBUTION_FAX_EXTENSION>
					<DISTRIBUTION_FAX_SUBJECT_TEXT>mailingAddress.</DISTRIBUTION_FAX_SUBJECT_TEXT>
					<DISTRIBUTION_FAX_MESSAGE_TEXT>mailingAddress.</DISTRIBUTION_FAX_MESSAGE_TEXT> -->
				</DISTRIBUTION>



			</#if>

			<#if recipient.faxInfo?has_content>
				<#assign faxInfo = recipient.faxInfo>

				<DISTRIBUTION>
					<!--what value should be  used here-->
					<DISTRIBUTION_ID_PK>2</DISTRIBUTION_ID_PK>

					<#if recipient.recipientRecordId?has_content>
						<RECIPIENT_RECORD_ID_PK>${recipient.recipientRecordId}</RECIPIENT_RECORD_ID_PK>
					</#if>
					<SR_DOCUMENT_ID_FK>${documentDetails.recordId}</SR_DOCUMENT_ID_FK>

					<DISTRIBUTION_DELIVERY_TYPE>Fax</DISTRIBUTION_DELIVERY_TYPE>
					<DISTRIBUTION_FAX_NUMBER>${faxInfo.faxNumber}</DISTRIBUTION_FAX_NUMBER>
					<DISTRIBUTION_FAX_EXTENSION>${faxInfo.faxNumberExtension}</DISTRIBUTION_FAX_EXTENSION>
					<DISTRIBUTION_FAX_SUBJECT_TEXT>${faxInfo.subjectText}</DISTRIBUTION_FAX_SUBJECT_TEXT>
					<DISTRIBUTION_FAX_MESSAGE_TEXT>${faxInfo.messageText}</DISTRIBUTION_FAX_MESSAGE_TEXT>
				</DISTRIBUTION>
			</#if>

			<#if recipient.emailInfo?has_content>
				<#assign emailInfo = recipient.emailInfo>
				<DISTRIBUTION>
					<!--what value should be  used here-->
					<DISTRIBUTION_ID_PK>2</DISTRIBUTION_ID_PK>

					<#if recipient.recipientRecordId?has_content>
						<RECIPIENT_RECORD_ID_PK>${recipient.recipientRecordId}</RECIPIENT_RECORD_ID_PK>
					</#if>
					<SR_DOCUMENT_ID_FK>${documentDetails.recordId}</SR_DOCUMENT_ID_FK>

					<DISTRIBUTION_DELIVERY_TYPE>Email</DISTRIBUTION_DELIVERY_TYPE>
					<DISTRIBUTION_EMAIL_ADDRESS>${emailInfo.emailAddress}</DISTRIBUTION_EMAIL_ADDRESS>
					<DISTRIBUTION_EMAIL_SUBJECT_TEXT>${emailInfo.subjectText}</DISTRIBUTION_EMAIL_SUBJECT_TEXT>
					<DISTRIBUTION_EMAIL_MESSAGE_TEXT>${emailInfo.messageText}</DISTRIBUTION_EMAIL_MESSAGE_TEXT>
				</DISTRIBUTION>
			</#if>


			</RECIPIENT>
			
		</#if>
</#macro>

<#macro recurseCCRecp recurNode docDetails>
	<#if recurNode?node_type = 'element' && recurNode?node_name='ccRecipient'>
		<@recipientDetails recipient=recurNode documentDetails=docDetails ccFlag="Y"/>
	</#if>
	
</#macro>

<#macro recurseSingleDataElement recurNode>
	<#if recurNode?node_type = 'text'>
		<#assign textValue = (recurNode.@@text)?trim>
		
		<#if textValue != "">
			<${recurNode?parent?node_name?upper_case}>${recurNode.@@text}</${recurNode?parent?node_name?upper_case}>
		</#if>
	</#if>
	<#list recurNode?children as singleElement>
		<@recurseSingleDataElement recurNode=singleElement/>
	</#list>

</#macro>

<#macro recurseTableDataElement recurNode>

	<#if recurNode?node_type = 'element' && recurNode?node_name='table'>
		<${recurNode?parent?node_name?upper_case}>
			<#list recurNode?children as tableElement>
				<@recurseRowDataElement recurNode=tableElement/>
			</#list>

		</${recurNode?parent?node_name?upper_case}>
	</#if>
	<#list recurNode?children as tableElement>
		<@recurseTableDataElement recurNode=tableElement/>
	</#list>
</#macro>

<#macro recurseRowDataElement recurNode>
	<#if recurNode?node_type = 'element' && recurNode?node_name='row'>
		<@recurseRows rowNode=recurNode/>
	<#else>
		<#list recurNode?children as rowElement>
			<@recurseRowDataElement recurNode=rowElement/>
		</#list>
	</#if>
</#macro>

<#macro recurseRows rowNode>
	<#list rowNode?children as rowElement>
		<#if rowElement?node_type = 'text'>
			<#assign textValue = (rowElement.@@text)?trim>
			<#if textValue != "">
				<${rowElement?parent?node_name?upper_case}>${rowElement.@@text}</${rowElement?parent?node_name?upper_case}>
			</#if>
		<#else>
			<@recurseRows rowNode=rowElement/>
		</#if>
	</#list>
</#macro>

<#macro checkNullValue xmlNode objectName elementName>
	<#if xmlNode.objectName?has_content>
		<${elementName}>${xmlNode.objectName}</${elementName}>
	</#if>
</#macro>